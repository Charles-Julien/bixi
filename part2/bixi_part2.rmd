---
title: "Part 2: Linear regression models"
author: "Charles Julien, Chike Odenigbo, Atul Sharma, Gabriel Jobert"
date: "10/20/2023"
output: github_document
---

# Instructions

• Explore linear regression models for the response variables of interest, specifically, for trip lengths (duration) and revenue.

• Be sure that your analyses allow you to answer well formulated business / research questions that you wish to explore through these models. The goal is to use linear regression models to provide interesting and relevant insights from the data.

• Comment on findings and discuss the main takeaways from these analyses from a business
perspective. Be sure to provide relevant model outputs that support your discussion.

• Discuss any shortcomings or limitations of the analyses carried out.


# Business/Research questions

Examples : 

Are revenues significantly higher during the weekend?

Does the average trip duration varies from member to non-member?


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message = FALSE, warning=FALSE, include = FALSE, echo=FALSE}
# Import (The fewer the better)

library(tidyverse)
library(ggplot2)
library(dplyr)
library(leaflet)
```



```{r load_data, include=FALSE}
# Data loading

# Set working directory to file location
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
df_raw = read.csv("./../src/bixi10.csv")
df_station = read.csv("./../src/2021_stations.csv")
df_main = left_join(df_raw,df_station,by = c("station"="pk"))
head(df_main)

```
# Build some regression models, discuss their relevances and test assumptions

```{r echo=FALSE}
# Data preparation and feature engineering

# ? dd is it a categorical variable or ordinal or else?

df_main <- df_main %>% mutate(
              holiday = factor(holiday),
              mem = factor(mem),
              mm = factor(mm),
              station = factor(station),
              
              #Overwrite old wday?
              wday_ordered = factor(wday, levels = c("Monday", "Tuesday", "Wednesday",  "Thursday", "Friday", "Saturday", "Sunday"),ordered = TRUE),
              season = ifelse((mm %in% c(12,1,2)), 'Winter',
                       ifelse((mm %in% c(3,4,5)), 'Spring',
                       ifelse((mm %in% c(6,7,8)), 'Summer',
                       ifelse((mm %in% c(9,10,11)), 'Fall','No Season')))),
              
              rain_ind = factor(ifelse((rain != 0), 'Rain', 'NoRain')),
              
              rev_per_min = rev/dur,
              rev_per_trip = rev/n_tot,
             
              percent_AM = n_AM/n_tot,
              percent_PM = n_PM/n_tot,
              
              percent_AM_PM_delta = percent_AM - percent_PM,
              n_AM_PM_delta = n_AM - n_PM,
              
              am_pm_ind = ifelse(n_AM>=n_PM, 'AM','PM'),
                
              wknd_ind = ifelse((wday %in% c("Sunday","Saturday")), 'Weekend'
                        ,ifelse((wday %in% c("Friday","Monday") & holiday=='1'),'Long Weekend','Weekday')))
        
 
```



```{r}
# Chunk of code
```

```{r}
# Chunk of code
```

```{r}
# Chunk of code
```

# Discuss the findings (business perspective)

blablabla

# Limitations and shortcomings

blablabla

# Contribution

Charles Julien :

Gabriel Jobert :

Chike Odenigbo: 

Atul Sharma: 